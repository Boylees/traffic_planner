# 交通网络路径规划与可视化系统

这是一个使用C语言实现的、功能丰富的路径规划项目。它不仅能计算两点或多点间的理论最优路径，还能将结果生成一个交互式的HTML地图报告，非常直观。

![项目截图](https://raw.githubusercontent.com/MizMiz6/traffic-planner-screenshots/main/screenshot.png)

---

## 核心功能

*   **多模式路径规划**: 综合考虑 **时间** 与 **金钱** 权重，在驾车、高铁、飞机、公交等多种交通方式中，规划出理论上的最优路线。
*   **Dijkstra单点最短路径**: 计算从A点到B点的最快、最省钱或最均衡的路线。
*   **TSP多点最优旅行**: 使用动态规划 (Held-Karp算法) 解决旅行商问题，找到访问多个城市并返回起点的最低成本路线。
*   **自定义顺序路径**: 规划一条严格按照用户指定顺序访问多个城市的路径。
*   **交互式地图可视化**:
    *   将规划结果自动生成一个 `route_visualization.html` 文件。
    *   在地图上用不同颜色的线条区分不同的交通方式。
    *   使用 ✈️, 🚄, 📍 等自定义图标区分机场、高铁站和地标。
    *   点击路径段，可以弹出窗口显示该段的详细数据（时间、花费、距离）。
    *   叠加中国省级行政区划图层，提供清晰的地理上下文。

---

## 技术栈

*   **语言**: C (C99标准)
*   **构建系统**: GNU Make
*   **核心算法**: Dijkstra, Held-Karp (TSP)
*   **可视化**: HTML, CSS, JavaScript (通过C语言生成)
*   **地图库**: [Leaflet.js](https://leafletjs.com/)

---

## 如何编译与运行

本项目依赖 `make` 和 `gcc` 编译器。

1.  **克隆或下载项目**
    ```bash
    git clone https://github.com/Boylees/traffic_planner
    ```

2.  **编译项目**
    在项目根目录下，直接运行 `make` 命令。
    ```bash
    make
    ```
    这将会编译所有的源文件，并将最终的可执行文件放在 `bin/traffic_planner`。

3.  **运行程序**
    ```bash
    ./bin/traffic_planner
    ```
    或者在Windows (MinGW/MSYS2) 环境下:
    ```bash
    ./bin/traffic_planner.exe
    ```
    程序启动后，会显示一个菜单，您可以根据提示选择需要的功能。每次路径规划成功后，都会在项目根目录生成或更新 `route_visualization.html` 文件，用浏览器打开即可查看可视化结果。

---

## 项目结构

经过重构，项目采用了模块化的设计，职责清晰，易于维护和扩展。

```
.
├── Makefile          # 自动化构建脚本
├── README.md         # 项目说明文档
├── bin/              # 存放编译生成的可执行文件和中间目标文件
├── data/
│   └── nodes.csv     # 核心数据文件，定义了所有城市、地标和交通枢纽
├── include/          # 存放所有模块的头文件 (.h)
│   ├── distance.h
│   ├── graph.h
│   ├── pathfinding.h
│   ├── types.h
│   ├── utils.h
│   └── visualization.h
├── src/              # 存放所有模块的实现文件 (.c)
│   ├── distance.c
│   ├── graph.c
│   ├── main.c
│   ├── pathfinding.c
│   ├── utils.c
│   └── visualization.c
└── route_visualization.html  # 程序运行后生成的交互式地图文件
```

---

## 核心算法简介

*   **Dijkstra算法**: 用于在图中寻找从单一源点到所有其他节点的最短路径。在本项目中，我们对它进行了改造，其"最短"的定义是一个基于`时间`和`金钱`的加权成本，使得路径的选择更贴近现实决策。

*   **Held-Karp算法**: 一个基于动态规划的经典算法，用于精确求解旅行商问题(TSP)。其时间复杂度为 `O(n^2 * 2^n)`，因此在本项目中限制了TSP的节点数量以保证性能。

---

## 已知局限性

本项目的路径规划是基于一个"**乌鸦飞行 (As-the-Crow-Flies)**"模型。节点之间的路径是根据其经纬度计算出的大圆航线（球体上的最短直线），而**没有考虑真实的道路网络或地理障碍（如山脉、海洋）**。

因此，您可能会在可视化地图上看到路线直接"飞跃"海洋或陆地，这是当前模型的正常行为。这个项目的主要价值在于演示路径规划的核心算法逻辑和模块化设计，而非提供一个可用于真实世界导航的工具。
